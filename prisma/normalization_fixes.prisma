// NUEVA TABLA: Horarios de sucursales (reemplaza openingHours Json)
model tbbranch_hours {
  PK_branch_hour Int       @id @default(autoincrement())
  FK_branch      Int
  day_of_week    Int       // 0=Domingo, 1=Lunes, 2=Martes, 3=Miércoles, 4=Jueves, 5=Viernes, 6=Sábado
  opening_time   String?   // "09:00"
  closing_time   String?   // "18:00"
  is_closed      Boolean   @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime?

  branch tbbranches @relation(fields: [FK_branch], references: [PK_branch])

  @@unique([FK_branch, day_of_week]) // Una sucursal tiene un horario por día
}

// NUEVA TABLA: Historial de acciones de sesiones de caja
model tbcash_session_actions {
  PK_action  Int            @id @default(autoincrement())
  FK_session Int
  action     String         // "OPEN", "CLOSE", "EXPENSE", "SALE"
  amount     Decimal?
  details    String?
  createdAt  DateTime       @default(now())

  session tbcash_sessions @relation(fields: [FK_session], references: [PK_session])
}

// NUEVA TABLA: Detalles de dispositivos (reemplaza devices Json)
model tbdevice_details {
  PK_device_detail Int       @id @default(autoincrement())
  FK_device        Int
  device_type      String    // "mobile", "desktop", "tablet"
  browser          String?
  os               String?
  user_agent       String?
  ip_address       String?
  last_seen        DateTime  @default(now())

  device tbdevices @relation(fields: [FK_device], references: [PK_device])
}</content>
<parameter name="filePath">c:\Users\oscar\Desktop\ecommerce-management\prisma\normalization_fixes.prisma